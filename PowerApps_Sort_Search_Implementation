Corrected and Clarified Requirements

You are using a SharePoint list as a data source. Your list has four Single Line of Text columns:

Â· DensoPartNumber
Â· CustomPartNumber
Â· SupplierPartNumber
Â· Supplier

In your Power Apps screen, you have:

1. A Header Gallery: To display the column names.
2. A Data Gallery: To display the records from the SharePoint list.
3. A Search Text Input Box: To allow users to search across any of the four columns.

Your functional requirements are:

Â· When the screen loads, the data in the Data Gallery should be sorted by DensoPartNumber in descending order.
Â· When a user clicks a column name in the Header Gallery, the Data Gallery should sort by that column. Clicking the same header again should toggle the sort order between ascending and descending.
Â· The search functionality should filter the records based on the user's input, matching against any of the four columns.
Â· All logic must avoid delegation warnings.



Below is the **clean, optimized, non-delegated + sortable + searchable** solution for your requirement.

---

# âœ… **Your Requirement**

* SharePoint list with **4 Single Line of Text** columns
  `DensoPartNumber`, `CustomPartNumber`, `SupplierPartNumber`, `Supplier`
* **GalleryHeader** â†’ to show column headers (click â†’ toggle Asc/Desc)
* **GalleryData** â†’ to show list records
* **Search TextInput** â†’ SearchBox
* **Need:**

  * Default sort â†’ DensoPartNumber **descending**
  * Click header â†’ toggle sort order
  * Search must work across all 4 columns
  * **NO delegation issues** (use `ClearCollect` locally)

---

# âœ… **1. OnVisible of Screen**

Load entire list locally â†’ delegation removed.

```powerfx
ClearCollect(
    colData,
    AddColumns(
        YourSharePointList,
        "Denso", DensoPartNumber,
        "Custom", CustomPartNumber,
        "SupplierPart", SupplierPartNumber,
        "SupplierName", Supplier
    )
);

// Default Sort Column & Order
Set(varSortColumn, "Denso");
Set(varSortOrder, SortOrder.Descending);
```

---

# âœ… **2. Header Gallery â€“ Items**

Hardcode header names.

```powerfx
[
    {Title:"DensoPartNumber", SortKey:"Denso"},
    {Title:"CustomPartNumber", SortKey:"Custom"},
    {Title:"SupplierPartNumber", SortKey:"SupplierPart"},
    {Title:"Supplier", SortKey:"SupplierName"}
]
```

---

# âœ… **3. OnSelect of Header Label**

Toggle sort column + order.

```powerfx
Set(
    varSortColumn,
    ThisItem.SortKey
);

Set(
    varSortOrder,
    If(
        varSortOrder = SortOrder.Ascending,
        SortOrder.Descending,
        SortOrder.Ascending
    )
);
```

---

# âœ… **4. Search Logic (works for all 4 columns)**

SearchBox â†’ **TextInputSearch.Text**

Use **Filter + SortByColumns** on local collection (non-delegated):

---

# âœ… **5. GalleryData â†’ Items**

```powerfx
SortByColumns(
    Filter(
        colData,
        IsBlank(TextInputSearch.Text) ||
        StartsWith(Denso, TextInputSearch.Text) ||
        StartsWith(Custom, TextInputSearch.Text) ||
        StartsWith(SupplierPart, TextInputSearch.Text) ||
        StartsWith(SupplierName, TextInputSearch.Text)
    ),
    varSortColumn,
    varSortOrder
)
```

---

# ğŸ‰ **Now your app supports:**

âœ” Non-delegated data (safe & fast)
âœ” Search on all 4 columns
âœ” Sort Asc/Desc toggle on header click
âœ” Default sort = DensoPartNumber in **descending**
âœ” Clean & optimized logic (no App.OnStart needed)


Extra Logic â¬‡ï¸ and â¬†ï¸


Perfect â€” here is the **cleanest and exact logic** so the sort icon:

### âœ… **1. Shows only for the 4 sortable columns**

### âœ… **Shows â†‘ or â†“ only when that column is the active sort column**

### âŒ **Does NOT show anything for the 8 non-sortable columns**

This is the correct, optimized setup.

---

# â­ 1. Header Gallery Structure

(You already have this â€” repeating only relevant part)

```powerfx
[
    {Title:"DensoPartNumber", SortKey:"Denso", CanSort:true},
    {Title:"CustomPartNumber", SortKey:"Custom", CanSort:true},
    {Title:"SupplierPartNumber", SortKey:"SupplierPart", CanSort:true},
    {Title:"Supplier", SortKey:"SupplierName", CanSort:true},

    // 8 columns without sort:
    {Title:"TYPE", SortKey:"", CanSort:false},
    {Title:"Model", SortKey:"", CanSort:false},
    ...
]
```

---

# â­ 2. Sort Icon (Image or Label) â†’ **Visible property**

Only visible for columns having sort logic:

```powerfx
ThisItem.CanSort && varSortColumn = ThisItem.SortKey
```

âœ” Shows only for the 4 sortable columns
âœ” Shows only when that column is currently sorted
âœ” Completely hidden for the 8 non-sortable columns

---

# â­ 3. Sort Icon â†’ **Text property (if using Label)**

```powerfx
If(
    varSortOrder = SortOrder.Ascending,
    "â†‘",
    "â†“"
)
```

OR for image control, choose icon name:

**Image property:**

```powerfx
If(
    varSortOrder = SortOrder.Ascending,
    Icon.ChevronUp,
    Icon.ChevronDown
)
```

---

# â­ 4. Full Logic for BOTH Visible + Text (Copy-Paste Ready)

### **Visible**

```powerfx
ThisItem.CanSort && varSortColumn = ThisItem.SortKey
```

### **Text**

```powerfx
If(
    varSortOrder = SortOrder.Ascending,
    "â†‘",
    "â†“"
)
```

---

# â­ 5. Optional: Header Label â†’ Text with Inline Arrow

If you want arrow next to header text in single control:

```powerfx
ThisItem.Title &
If(
    ThisItem.CanSort && varSortColumn = ThisItem.SortKey,
    If(
        varSortOrder = SortOrder.Ascending,
        " â†‘",
        " â†“"
    ),
    ""
)
```

âœ” Arrow shows ONLY for sortable columns
âœ” Arrow switches up/down
âœ” No arrow for non-sortable columns

---

# ğŸ‰ Final Result

* 8 non-sortable headers â†’ **NO icon, no arrow, no error**
* 4 sortable headers â†’ **icon appears only when active**
* Arrow â†‘ / â†“ properly toggles
* No duplication
* Cleanest Power Apps pattern

---







